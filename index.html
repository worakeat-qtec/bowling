<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bowling Logic Explorer - Top Score Version</title>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #f8fafc; display: flex; flex-direction: column; align-items: center; padding: 40px; }
        .container { background: white; padding: 40px; border-radius: 12px; box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1); width: 1050px; }
        h2 { color: #1e3a8a; text-align: center; margin-bottom: 30px; display: flex; justify-content: center; align-items: center; gap: 10px; }
        
        /* Table Layout */
        .scorecard { border-collapse: collapse; width: 100%; table-layout: fixed; margin-bottom: 25px; border: 2px solid #1e3a8a; }
        .scorecard th, .scorecard td { border: 1px solid #94a3b8; text-align: center; }
        .frame-num { background: #1e3a8a; color: white; padding: 8px; font-weight: bold; font-size: 14px; }
        
        /* ‡πÅ‡∏ñ‡∏ß‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏ß‡∏° (‡∏¢‡πâ‡∏≤‡∏¢‡∏°‡∏≤‡∏Ç‡πâ‡∏≤‡∏á‡∏ö‡∏ô) */
        .frame-total { height: 60px; font-size: 24px; font-weight: bold; color: #ea580c; background: #fff7ed; vertical-align: middle; }
        
        /* ‡πÅ‡∏ñ‡∏ß‡∏ä‡πà‡∏≠‡∏á‡∏Å‡∏£‡∏≠‡∏Å (‡∏¢‡πâ‡∏≤‡∏¢‡∏°‡∏≤‡∏Ç‡πâ‡∏≤‡∏á‡∏•‡πà‡∏≤‡∏á) */
        .rolls { display: flex; height: 40px; background: #fff; }
        .rolls input { width: 100%; border: none; text-align: center; font-size: 18px; font-weight: bold; outline: none; background: transparent; }
        .rolls input:nth-child(1) { border-right: 1px solid #94a3b8; }
        .rolls input:nth-child(3) { border-left: 1px solid #94a3b8; }
        input:focus { background: #e2e8f0; }

        /* Logic Box */
        .logic-panel { background: #fefce8; border-left: 4px solid #f59e0b; padding: 20px; margin: 0 auto 30px auto; width: 95%; border-radius: 4px; }
        .logic-panel h3 { margin-top: 0; color: #92400e; font-size: 1.1rem; border-bottom: 1px solid #fef3c7; padding-bottom: 8px; }
        .log-item { font-size: 1rem; color: #451a03; font-family: 'Consolas', monospace; margin: 6px 0; }
        .highlight { font-weight: bold; color: #ea580c; }

        /* Total Box */
        .total-container { display: flex; justify-content: center; margin-top: 10px; }
        .total-box { background: #1e3a8a; color: white; padding: 15px 50px; border-radius: 8px; font-size: 26px; font-weight: bold; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1); }
        input::-webkit-outer-spin-button, input::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }
    </style>
</head>
<body>

<div class="container">
    <h2>üé≥ Bowling Score Simulator</h2>
    
    <table class="scorecard">
        <tr id="frame-numbers"></tr>
        <tr id="score-rows"></tr> <tr id="input-rows"></tr> </table>

    <div class="logic-panel">
        <h3>üîç ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏™‡∏π‡∏ï‡∏£‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì (Real-time Trace):</h3>
        <div id="logic-content">‡∏£‡∏∞‡∏ö‡∏ö‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì... ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏û‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡∏•‡πâ‡∏°‡πÉ‡∏ô‡∏ä‡πà‡∏≠‡∏á‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô</div>
    </div>

    <div class="total-container">
        <div class="total-box">Total Score: <span id="grand-total">0</span></div>
    </div>
</div>

<script>
    const frameNumbersRow = document.getElementById('frame-numbers');
    const inputRows = document.getElementById('input-rows');
    const scoreRows = document.getElementById('score-rows');

    for (let i = 1; i <= 10; i++) {
        // 1. ‡∏´‡∏±‡∏ß‡∏ï‡∏≤‡∏£‡∏≤‡∏á (‡πÄ‡∏•‡∏Ç‡πÄ‡∏ü‡∏£‡∏°)
        const th = document.createElement('th');
        th.className = 'frame-num';
        th.innerText = `‡πÄ‡∏ü‡∏£‡∏° ${i}`;
        frameNumbersRow.appendChild(th);

        // 2. ‡πÅ‡∏ñ‡∏ß‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏ß‡∏° (Frame Total) - ‡∏¢‡πâ‡∏≤‡∏¢‡∏°‡∏≤‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏ó‡∏µ‡πà 2
        const tdScore = document.createElement('td');
        tdScore.id = `f${i}-total`;
        tdScore.className = 'frame-total';
        scoreRows.appendChild(tdScore);

        // 3. ‡πÅ‡∏ñ‡∏ß‡∏ä‡πà‡∏≠‡∏á‡∏Å‡∏£‡∏≠‡∏Å‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô (Rolls) - ‡∏¢‡πâ‡∏≤‡∏¢‡∏°‡∏≤‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏ó‡∏µ‡πà 3
        const tdInput = document.createElement('td');
        const rollDiv = document.createElement('div');
        rollDiv.className = 'rolls';
        const rollCount = (i === 10) ? 3 : 2;
        for (let r = 1; r <= rollCount; r++) {
            const input = document.createElement('input');
            input.type = 'number';
            input.id = `f${i}r${r}`;
            input.oninput = calculateBowling;
            rollDiv.appendChild(input);
        }
        tdInput.appendChild(rollDiv);
        inputRows.appendChild(tdInput);
    }

    function calculateBowling() {
        let rolls = [];
        let rawInputs = [];
        for (let i = 1; i <= 10; i++) {
            let r1 = parseInt(document.getElementById(`f${i}r1`).value);
            let r2 = parseInt(document.getElementById(`f${i}r2`).value);
            let r3 = (i === 10) ? parseInt(document.getElementById(`f${i}r3`).value) : null;
            rawInputs.push({r1, r2, r3});
        }
        for(let i=0; i<9; i++) {
            let {r1, r2} = rawInputs[i];
            if(!isNaN(r1)) {
                rolls.push(r1);
                if(r1 !== 10) rolls.push(isNaN(r2) ? null : r2);
                else rolls.push(0); 
            } else rolls.push(null, null);
        }
        rolls.push(isNaN(rawInputs[9].r1) ? null : rawInputs[9].r1);
        rolls.push(isNaN(rawInputs[9].r2) ? null : rawInputs[9].r2);
        rolls.push(isNaN(rawInputs[9].r3) ? null : rawInputs[9].r3);

        let total = 0; let rollIdx = 0; let frameTotals = []; let logs = [];

        for (let f = 0; f < 10; f++) {
            let currentRoll = rolls[rollIdx];
            if (currentRoll === null) break;

            if (f < 9 && currentRoll === 10) { // STRIKE
                let b1 = rolls[rollIdx + 2];
                let b2 = (b1 === 10 && f < 8) ? rolls[rollIdx + 4] : rolls[rollIdx + 3];
                if (b1 !== null && b2 !== null) {
                    let fScore = 10 + b1 + b2; total += fScore; frameTotals[f] = total;
                    logs.push(`‡πÄ‡∏ü‡∏£‡∏° ${f+1} [Strike]: 10 + (${b1} + ${b2}) = ${fScore} | ‡∏™‡∏∞‡∏™‡∏°: <span class="highlight">${total}</span>`);
                }
                rollIdx += 2;
            } else if (f < 9 && (currentRoll + rolls[rollIdx+1] === 10)) { // SPARE
                let b1 = rolls[rollIdx + 2];
                if (b1 !== null) {
                    let fScore = 10 + b1; total += fScore; frameTotals[f] = total;
                    logs.push(`‡πÄ‡∏ü‡∏£‡∏° ${f+1} [Spare]: 10 + (${b1}) = ${fScore} | ‡∏™‡∏∞‡∏™‡∏°: <span class="highlight">${total}</span>`);
                }
                rollIdx += 2;
            } else if (f < 9) { // OPEN
                let r2 = rolls[rollIdx+1];
                if (r2 !== null) {
                    let fScore = currentRoll + r2; total += fScore; frameTotals[f] = total;
                    logs.push(`‡πÄ‡∏ü‡∏£‡∏° ${f+1} [Open]: ${currentRoll} + ${r2} = ${fScore} | ‡∏™‡∏∞‡∏™‡∏°: <span class="highlight">${total}</span>`);
                }
                rollIdx += 2;
            } else { // FRAME 10
                let r1 = rolls[rollIdx], r2 = rolls[rollIdx+1], r3 = rolls[rollIdx+2];
                if (r1 !== null && r2 !== null) {
                    let fScore = r1 + r2 + (isNaN(r3) ? 0 : r3); total += fScore; frameTotals[f] = total;
                    logs.push(`‡πÄ‡∏ü‡∏£‡∏° 10: ${r1} + ${r2} + ${isNaN(r3)?0:r3} = ${fScore} | ‡∏™‡∏∞‡∏™‡∏°: <span class="highlight">${total}</span>`);
                }
            }
        }
        for (let i = 1; i <= 10; i++) document.getElementById(`f${i}-total`).innerText = frameTotals[i-1] || "";
        document.getElementById('grand-total').innerText = total;
        document.getElementById('logic-content').innerHTML = logs.length > 0 ? logs.map(l => `<div class="log-item">${l}</div>`).join('') : "‡∏Å‡∏£‡∏≠‡∏Å‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π Trace Log...";
    }
</script>

</body>
</html>