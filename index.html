<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bowling Simulator - Logic Debugger</title>
    <style>
        :root {
            --primary-blue: #1e3a8a;
            --accent-orange: #ea580c;
            --bg-slate: #f8fafc;
            --danger-red: #dc2626;
        }

        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: var(--bg-slate); margin: 0; padding: 20px; display: flex; flex-direction: column; align-items: center; }
        .container { background: white; padding: 20px; border-radius: 12px; box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1); width: 95%; max-width: 1100px; box-sizing: border-box; }
        h2 { color: var(--primary-blue); text-align: center; margin-top: 0; font-size: 1.5rem; }

        .table-wrapper { width: 100%; overflow-x: auto; margin-bottom: 20px; border: 2px solid var(--primary-blue); border-radius: 8px; -webkit-overflow-scrolling: touch; }
        .scorecard { border-collapse: collapse; min-width: 950px; width: 100%; table-layout: fixed; }
        .scorecard th, .scorecard td { border: 1px solid #94a3b8; text-align: center; }
        .frame-num { background: var(--primary-blue); color: white; padding: 10px; font-weight: bold; font-size: 14px; }
        .frame-total { height: 65px; font-size: 24px; font-weight: bold; color: var(--accent-orange); background: #fff7ed; }
        
        .rolls { display: flex; height: 45px; background: #fff; }
        .rolls input { width: 100%; border: none; text-align: center; font-size: 18px; font-weight: bold; outline: none; }
        .rolls input:nth-child(1) { border-right: 1px solid #94a3b8; }
        .rolls input:nth-child(3) { border-left: 1px solid #94a3b8; }

        /* Logic Panel ‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡πÉ‡∏´‡∏°‡πà */
        .logic-panel { background: #fefce8; border-left: 5px solid #f59e0b; padding: 20px; margin-bottom: 20px; border-radius: 4px; }
        .logic-panel h3 { margin: 0 0 15px 0; color: #92400e; font-size: 1.1rem; display: flex; align-items: center; gap: 8px; }
        .log-item { font-size: 0.95rem; color: #451a03; font-family: 'Consolas', monospace; margin: 10px 0; padding-bottom: 8px; border-bottom: 1px dashed #fef3c7; line-height: 1.6; }
        .highlight { font-weight: bold; color: var(--accent-orange); }
        .source-tag { background: #fef3c7; padding: 2px 6px; border-radius: 4px; font-size: 0.85rem; color: #78350f; border: 1px solid #fde68a; }

        .controls-container { display: flex; flex-wrap: wrap; justify-content: center; align-items: center; gap: 15px; }
        .total-box { background: var(--primary-blue); color: white; padding: 15px 40px; border-radius: 8px; font-size: 1.6rem; font-weight: bold; min-width: 200px; text-align: center; }
        .reset-btn { background: var(--danger-red); color: white; border: none; padding: 15px 30px; border-radius: 8px; font-size: 1.1rem; font-weight: bold; cursor: pointer; }
        
        @media (max-width: 600px) { .controls-container { flex-direction: column; } .total-box, .reset-btn { width: 100%; } }
    </style>
</head>
<body>

<div class="container">
    <h2>üé≥ Bowling Simulator - Logic Debugger</h2>
    
    <div class="table-wrapper">
        <table class="scorecard">
            <tr id="frame-numbers"></tr>
            <tr id="score-rows"></tr>
            <tr id="input-rows"></tr>
        </table>
    </div>

    <div class="logic-panel">
        <h3>üîç ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏ó‡∏µ‡πà‡∏°‡∏≤‡∏Ç‡∏≠‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç (Calculation Trace):</h3>
        <div id="logic-content">‡∏Å‡∏£‡∏≠‡∏Å‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á Logic...</div>
    </div>

    <div class="controls-container">
        <div class="total-box">Total Score: <span id="grand-total">0</span></div>
        <button class="reset-btn" onclick="resetScores()">‡∏•‡πâ‡∏≤‡∏á‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
    </div>
</div>

<script>
    const frameNumbersRow = document.getElementById('frame-numbers');
    const inputRows = document.getElementById('input-rows');
    const scoreRows = document.getElementById('score-rows');

    for (let i = 1; i <= 10; i++) {
        const th = document.createElement('th');
        th.className = 'frame-num'; th.innerText = `‡πÄ‡∏ü‡∏£‡∏° ${i}`;
        frameNumbersRow.appendChild(th);

        const tdScore = document.createElement('td');
        tdScore.id = `f${i}-total`; tdScore.className = 'frame-total';
        scoreRows.appendChild(tdScore);

        const tdInput = document.createElement('td');
        const rollDiv = document.createElement('div'); rollDiv.className = 'rolls';
        const rollCount = (i === 10) ? 3 : 2;
        for (let r = 1; r <= rollCount; r++) {
            const input = document.createElement('input');
            input.type = 'number'; input.inputMode = 'numeric';
            input.id = `f${i}r${r}`; input.oninput = calculateBowling;
            rollDiv.appendChild(input);
        }
        tdInput.appendChild(rollDiv); inputRows.appendChild(tdInput);
    }

    function resetScores() {
        if(confirm("‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î?")) {
            document.querySelectorAll('input').forEach(i => i.value = '');
            calculateBowling();
        }
    }

    function calculateBowling() {
        let rawInputs = [];
        for (let i = 1; i <= 10; i++) {
            let r1 = parseInt(document.getElementById(`f${i}r1`).value);
            let r2 = parseInt(document.getElementById(`f${i}r2`).value);
            let r3 = (i === 10) ? parseInt(document.getElementById(`f${i}r3`).value) : NaN;
            rawInputs.push({r1, r2, r3});
        }

        let total = 0; let logs = [];
        
        for (let i = 0; i < 10; i++) {
            let currentFrame = i + 1;
            let fData = rawInputs[i];

            if (isNaN(fData.r1)) break;

            // --- STRIKE (Frame 1-9) ---
            if (i < 9 && fData.r1 === 10) {
                let nextF = rawInputs[i+1];
                if (nextF && !isNaN(nextF.r1)) {
                    let b1 = nextF.r1;
                    let b2 = NaN;
                    let b2Source = "";

                    if (i < 8) { // ‡πÄ‡∏ü‡∏£‡∏° 1-8
                        if (b1 === 10) {
                            let nNextF = rawInputs[i+2];
                            if (nNextF && !isNaN(nNextF.r1)) {
                                b2 = nNextF.r1;
                                b2Source = `‡∏•‡∏π‡∏Å 1 ‡πÄ‡∏ü‡∏£‡∏° ${currentFrame + 2}`;
                            }
                        } else if (!isNaN(nextF.r2)) {
                            b2 = nextF.r2;
                            b2Source = `‡∏•‡∏π‡∏Å 2 ‡πÄ‡∏ü‡∏£‡∏° ${currentFrame + 1}`;
                        }
                    } else { // ‡πÄ‡∏ü‡∏£‡∏° 9 (‡πÇ‡∏ö‡∏ô‡∏±‡∏™‡∏°‡∏≤‡∏à‡∏≤‡∏Å‡πÄ‡∏ü‡∏£‡∏° 10)
                        if (!isNaN(nextF.r2)) {
                            b2 = nextF.r2;
                            b2Source = `‡∏•‡∏π‡∏Å 2 ‡πÄ‡∏ü‡∏£‡∏° 10`;
                        }
                    }

                    if (!isNaN(b2)) {
                        let fScore = 10 + b1 + b2; total += fScore;
                        document.getElementById(`f${currentFrame}-total`).innerText = total;
                        logs.push(`<div class="log-item"><b>‡πÄ‡∏ü‡∏£‡∏° ${currentFrame} [Strike]:</b> 10 + (<span class="source-tag">${b1} ‡∏à‡∏≤‡∏Å‡πÄ‡∏ü‡∏£‡∏° ${currentFrame+1}</span> + <span class="source-tag">${b2} ‡∏à‡∏≤‡∏Å${b2Source}</span>) = ${fScore} | ‡∏™‡∏∞‡∏™‡∏°: <span class="highlight">${total}</span></div>`);
                    } else { document.getElementById(`f${currentFrame}-total`).innerText = ""; }
                }
            } 
            // --- SPARE (Frame 1-9) ---
            else if (i < 9 && fData.r1 + fData.r2 === 10) {
                let nextF = rawInputs[i+1];
                if (nextF && !isNaN(nextF.r1)) {
                    let b1 = nextF.r1;
                    let fScore = 10 + b1; total += fScore;
                    document.getElementById(`f${currentFrame}-total`).innerText = total;
                    logs.push(`<div class="log-item"><b>‡πÄ‡∏ü‡∏£‡∏° ${currentFrame} [Spare]:</b> 10 + (<span class="source-tag">${b1} ‡∏à‡∏≤‡∏Å‡∏•‡∏π‡∏Å 1 ‡πÄ‡∏ü‡∏£‡∏° ${currentFrame+1}</span>) = ${fScore} | ‡∏™‡∏∞‡∏™‡∏°: <span class="highlight">${total}</span></div>`);
                } else { document.getElementById(`f${currentFrame}-total`).innerText = ""; }
            }
            // --- OPEN (Frame 1-9) ---
            else if (i < 9 && !isNaN(fData.r2)) {
                let fScore = fData.r1 + fData.r2; total += fScore;
                document.getElementById(`f${currentFrame}-total`).innerText = total;
                logs.push(`<div class="log-item"><b>‡πÄ‡∏ü‡∏£‡∏° ${currentFrame} [Open]:</b> <span class="source-tag">${fData.r1}</span> + <span class="source-tag">${fData.r2}</span> = ${fScore} | ‡∏™‡∏∞‡∏™‡∏°: <span class="highlight">${total}</span></div>`);
            }
            // --- FRAME 10 ---
            else if (i === 9) {
                if (!isNaN(fData.r1) && !isNaN(fData.r2)) {
                    let needsThird = (fData.r1 + fData.r2 >= 10);
                    if (!needsThird || !isNaN(fData.r3)) {
                        let r3Val = isNaN(fData.r3) ? 0 : fData.r3;
                        let fScore = fData.r1 + fData.r2 + r3Val; total += fScore;
                        document.getElementById(`f10-total`).innerText = total;
                        logs.push(`<div class="log-item"><b>‡πÄ‡∏ü‡∏£‡∏° 10:</b> <span class="source-tag">${fData.r1}</span> + <span class="source-tag">${fData.r2}</span> + <span class="source-tag">${r3Val}</span> = ${fScore} | ‡∏™‡∏∞‡∏™‡∏°: <span class="highlight">${total}</span></div>`);
                    }
                }
            } else { document.getElementById(`f${currentFrame}-total`).innerText = ""; }
        }
        document.getElementById('grand-total').innerText = total;
        document.getElementById('logic-content').innerHTML = logs.length > 0 ? logs.join('') : "‡∏Å‡∏£‡∏≠‡∏Å‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå...";
    }
</script>

</body>
</html>